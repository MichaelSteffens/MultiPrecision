#define CATCH_CONFIG_MAIN
#include "catch.hpp"

#include "MultiPrecision/math.h"
#include <sstream>

TEST_CASE("Unsigned exponentiation", "[unsigned]")
{
	REQUIRE(
		MultiPrecision::pow(MultiPrecision::Unsigned("0x23"), MultiPrecision::Unsigned("0x0815")) ==
		"0x166aea00eeb05ea4edbe2ac3c9349fd07101e05a1b306b3a39c3834ddb10b12d51f97a608e7822e38cb39568dee22f7b02c8762cff4fed15de5f1076"
		"d1396046cd961b98381a80c90b56ee2914b0bac239a311f1e853b837f87be761ce4b184e21f7808eb85a3ad8298c7826b8d3aab3995c346e395f3430b3"
		"85bd74a1e02fe5b48a604550e23cdddcac4af749044397f1ae4b49f95bebc05c11d451990ec115adaee2b8a602268c960f305ad3904ecbb1dc5e4ae5e4"
		"aa3307420bae3fc7a4e0c30b9fee91afada4bd71878d20b57b02671f48233938be331071acc762594c6f38e0b96f608b488ae04a10c98738affd8c52d1"
		"749fa8206ea5e9f16f185de38c480381173e565b845e6cc353b38bc4e1b02d3e821f2ddebc1880c21bd1f6203079014580ef4aaa606e9ffc644fe54eb8"
		"a5cce38116e3c1912ac9b24eb9a9d2fe5d315464f0026de0f9cc1841a1733e92a7d1eb2c009bd21be89d300dec8f062f23858551d75954c65280d3801c"
		"8b415600e3eaac767f73cd5498841ebd725079aa0f0f047a392664014bedc25fdf5652889d27587caa18be9375222986b17207f672ac6316d68e9fb387"
		"df18bef9d8c2e314ce5b5c54444fba712eb95046e86eb1e76cb5437a3d73874decc5605c7e2665a55806af2a1156014e1346e0a07b7be078b29f35f6f9"
		"b53c99e363aad18deb63e823acea4324930451150843fb113c472d5fbe0aa6ccdf1d7a5b68b22b943e99ee85aa8fba321349398a124044f91b40783a59"
		"b638f5d3895c07b68aa553fa26e89424f9a35118f442bfeb6bfbfae5b9eb4070ae70f40c28605b539e4337f099bcbdc880de739c849bf5ef48d46ba5d1"
		"7843f1cf8ba5361194651ba18d7d76e163be8df3577d6b60e779daf8391e39af3f3b657cabae832bde4b68ebb56705c3b45e047041cf4c0a1b95ada9c2"
		"18f7c866388a66aeb99f94fc529dcde90f9ef0dbd3a97dd2ee04129e07a7ea978c633361dda51d293849ca14689b9ad485184b397e3e48d80f227ec117"
		"96236649d128ecdf2ea095074b4ff682c7c613a76b58bb998085b0a8ffbd0b8ae24f65197dbc76be2742bc8b0a3d07b2b53a3bada9d39a1a16c927ad57"
		"a96b529326d4250b7450ed95658d44b6a174b3a76aef33945f056be3c4828ca7dfdb739730bdb60a80ab2d5ce8d2315cfbe4887ea7e5d59472501b3f30"
		"d7394c94f379194f3da3b50ad8aa3f8e22b71f9108c6fd41cbf5ed22e08287b4f0d899ad6ab0c6470bf22a4cef01ed7c7e16cd1b56316e3d09b31994c8"
		"1e65ebd91ee5100daa0976a9dd4550e977dc3a68c9f405778d6d5e5b332733a34e5244372908137861b77b05b8b08eabc3af10851cf3a484eb7b4c997d"
		"994f139b31614db7bbf3e4e44c1f3036ea95fdfd110893593f4472df3b77215829e70eb389e335c9f4e307853b0a20dfd9a9a66e47fd5bd22711c66888"
		"6744f1d96dec816b2f037819c283ccbbd79544f1f20dbd0e0761557f19a59ea155759d5874cf8fd7801c923302be017bf691c148003cd7fefd4d8e9ca1"
		"1f8d34449e5f46b5cd1b3cc2db2b876a25c05a94bed388c8c094dee67a48ebe87e19681e13a9b7b536b92db0ff015b3ac81c27ba4759b9391142760cd3"
		"a6e96860fdd537af7bc829af6a2c8cdec3efdf27497443b90e786b2ed064473c78b7d3fe6a51a5c43719abda3918e309ae06d0fe4f1674e1ee7aba2a5f"
		"bdc83f50b70c7a18b1f00b1bdec4752356620169051baa78d78cf0803648727d3bc6bb05027b8bbd2a455659e6f122091c84167fda96d4873a22f54151"
		"632a8e7308a0f9dbb26211cfffab0a9e23e9b12337f63f3b27fdfce8f00d4c348d97e0791dcb2f9364ffcdaf962753");
}

TEST_CASE("Unsigned exponentiation over modulus", "[unsigned]")
{
	MultiPrecision::Unsigned prime("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed");
	REQUIRE(
		MultiPrecision::pow(MultiPrecision::Unsigned("0x23"), MultiPrecision::Unsigned("0x0815"), prime) ==
		"0x44b4c02207fd6005f7fc1330633e09c0565fd9c881e3e87bb3b64994cbff1c53");
}
